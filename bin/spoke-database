#!/usr/bin/env python
import sys
import asyncio
import spoke


class Database:
    def __init__(self):
        self.__database = {}

    async def put(self, channel, data):
        self.__database.update(data)

    async def get(self, channel, key):
        return self.__database.get(key, None)


async def main():
    database = Database()
    client = spoke.pubsub.client.Client()
    await client.run()
    await client.subscribe("database/put", database.put)
    await client.provide("database/get", database.get)
    spoke.wait.wait()

asyncio.run(main())
