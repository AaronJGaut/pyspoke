#!/usr/bin/env python
import json
import spoke

import argparse

parser = argparse.ArgumentParser()
parser.add_argument("channel")
parser.add_argument("payload", nargs="?", default=None)
parser.add_argument("-t", "--timeout", type=float, default=None)
args = parser.parse_args()

if args.payload is None:
    payload = args.payload
else:
    payload = json.loads(args.payload)

print(spoke.simple.call(args.channel, payload, timeout=args.timeout))
