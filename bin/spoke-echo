#!/usr/bin/env python
import sys

channels = sys.argv[1:]
if not channels:
    channels = ["**"]

import asyncio
from spoke.pubsub.client import Client

async def echo(channel, msg):
    print("{}: {}".format(channel, msg))

async def main():
    client = Client()
    await client.run()
    await asyncio.gather(*[client.subscribe(x, echo) for x in channels])
    while True:
        await asyncio.sleep(1)

try:
    asyncio.run(main())
except KeyboardInterrupt:
    pass
